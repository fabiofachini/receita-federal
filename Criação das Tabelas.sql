-- Criacao da base de dados

CREATE DATABASE RECEITAFEDERAL
     WITH TEMPLATE = template0 
     ENCODING 'WIN1252' 
     LC_CTYPE = 'Portuguese_Brazil.1252' 
     LC_COLLATE = 'Portuguese_Brazil.1252'
;


-- Criacao da tabela EMPRESAS

CREATE TABLE EMPRESAS (
	CNPJ_BASICO VARCHAR(8) PRIMARY KEY,
	RAZAO_SOCIAL VARCHAR(200),
	NATUREZA_JURIDICA VARCHAR(4),
	QUALIFICACAO_RESPONSAVEL VARCHAR(2),
	CAPITAL_SOCIAL VARCHAR(20),
	PORTE VARCHAR(2),
	ENTE_FEDERATIVO VARCHAR(50)
	)
;


-- Criacao da tabela ESTABELECIMENTOS

CREATE TABLE ESTABELECIMENTOS (
	CNPJ_BASICO VARCHAR(8),
	CNPJ_ORDEM VARCHAR(4),
	CNPJ_DV VARCHAR(2),
	MATRIZ_FILIAL VARCHAR(1),
	NOME_FANTASIA VARCHAR(200),
	SITUACAO_CADASTRAL VARCHAR(2),
	DATA_SITUACAO DATE(8),
	MOTIVO_SITUACAO VARCHAR(2),
	NOME_CIDADE_EXTERIOR VARCHAR(200),
	PAIS VARCHAR(200),
	DATA_INICIO DATE,
	CNAE_PRINCIPAL VARCHAR(20),
	CNAE_SECUNDARIO VARCHAR(1000),
	TIPO_LOGRADOURO VARCHAR(50),
	LOGRADOURO VARCHAR(200),
	NUMERO_LOGRADOURO VARCHAR(15),
	COMPLEMENTO_LOGRADOURO VARCHAR(200),
	BAIRRO VARCHAR(200),
	CEP VARCHAR(8),
	UF VARCHAR(2),
	MUNICIPIO VARCHAR(50),
	DDD1 VARCHAR(10),
	TELEFONE1 VARCHAR(10),
	DDD2 VARCHAR(10),
	TELEFONE2 VARCHAR(10),
	DDDFAX VARCHAR(10),
	FAX VARCHAR(10),
	EMAIL VARCHAR(200),
	SITUACAO_ESPECIAL VARCHAR(50),
	DATA_SITUACAO_ESPECIAL DATE
     )
;


-- Criacao da tabela de SOCIOS

CREATE TABLE SOCIOS (
	CNPJ_BASICO VARCHAR(8),
	IDENTIFICADOR_SOCIO CHAR(3),
	NOME_SOCIO VARCHAR(200),
	CPF_CNPJ_SOCIO VARCHAR(14),
	QUALIFICACAO_SOCIO VARCHAR(2),
	DATA_ENTRADA_SOCIEDADE DATE,
	PAIS VARCHAR(10),
	CPF_REPRESENTANTE_LEGAL VARCHAR(14),
	NOME_REPRESENTANTE_LEGAL VARCHAR(100),
	QUALIFICACAO_REPRESENTANTE_LEGAL CHAR(2),
	FAIXA_ETARIA CHAR(1)
     )
;


-- Criacao da tabela SIMPLES NACIONAL

CREATE TABLE SIMPLES (
	CNPJ_BASICO CHAR(8) PRIMARY KEY,
	OPCAO_SIMPLES CHAR(1),
	DATA_OPCAO_SIMPLES DATE,
	DATA_EXCLUSAO_SIMPLES DATE,
	OPCAO_MEI CHAR(1),
	DATA_OPCAO_MEI DATE,
	DATA_EXCLUSAO_MEI DATE
     )
;


-- Criacao tabela CNAE

CREATE TABLE CNAE (
	CODIGO_CNAE VARCHAR(10) PRIMARY KEY,
	NOME_CNAE VARCHAR(200)
     )
;


-- Criacao da tabela MOTIVOS

CREATE TABLE MOTIVOS (
	CODIGO_SITUACAO CHAR(2) PRIMARY KEY,
	DESCRICAO_SITUACAO VARCHAR(200)
     )
;


-- Criacao tabela MUNICIPIO

CREATE TABLE MUNICIPIO (
	CODIGO_MUNICIPIO VARCHAR(10) PRIMARY KEY,
	NOME_MUNICIPIO VARCHAR(50)
     )
;


-- Criacao da tabela NATUREZA JURIDICA

CREATE TABLE NATUREZA (
	CODIGO_NATUREZA_JURIDICA CHAR(4) PRIMARY KEY,
	DESCRICAO_NATUREZA_JURIDICA VARCHAR(200)
     )
;


-- Criacao da tabela PAIS

CREATE TABLE PAIS (
	CODIGO_PAIS VARCHAR(10) PRIMARY KEY,
	NOME_PAIS VARCHAR(50)
     )
;


-- Criacao da tabela QUALIFICACAO DOS SOCIOS


CREATE TABLE QUALIFICACAO (
	CODIGO_QUALIFICACAO_SOCIO CHAR(2) PRIMARY KEY,
	DESCRICAO_QUALIFICACAO_SOCIO VARCHAR(200)
     )
;
--______________________________________________________________________________________________

--Importacao dos arquivos no PSQL

\COPY SIMPLES FROM 'D:/Simples/F.K03200$W.SIMPLES.CSV.D30114' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY CNAE FROM 'D:/Cnaes/F.K03200$Z.D30114.CNAECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY MOTIVOS FROM 'D:/Motivos/F.K03200$Z.D30114.MOTICSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY MUNICIPIO FROM 'D:/Municipios/F.K03200$Z.D30114.MUNICCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY NATUREZA FROM 'D:/Naturezas/F.K03200$Z.D30114.NATJUCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY PAIS FROM 'D:/Paises/F.K03200$Z.D30114.PAISCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY QUALIFICACAO FROM 'D:/Qualificacoes/F.K03200$Z.D30114.QUALSCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas0/K3241.K03200Y0.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas1/K3241.K03200Y1.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas2/K3241.K03200Y2.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas3/K3241.K03200Y3.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas4/K3241.K03200Y4.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas5/K3241.K03200Y5.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas6/K3241.K03200Y6.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas7/K3241.K03200Y7.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas8/K3241.K03200Y8.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY EMPRESAS FROM 'D:/Empresas9/K3241.K03200Y9.D30114.EMPRECSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos0/K3241.K03200Y0.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos1/K3241.K03200Y1.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos2/K3241.K03200Y2.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos3/K3241.K03200Y3.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos4/K3241.K03200Y4.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos5/K3241.K03200Y5.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos6/K3241.K03200Y6.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos7/K3241.K03200Y7.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos8/K3241.K03200Y8.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY ESTABELECIMENTOS FROM 'D:/Estabelecimentos9/K3241.K03200Y9.D30114.ESTABELE' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios0/K3241.K03200Y0.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios1/K3241.K03200Y1.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios2/K3241.K03200Y2.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios3/K3241.K03200Y3.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios4/K3241.K03200Y4.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios5/K3241.K03200Y5.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios6/K3241.K03200Y6.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios7/K3241.K03200Y7.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios8/K3241.K03200Y8.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';
\COPY SOCIOS FROM 'D:/Socios9/K3241.K03200Y9.D30114.SOCIOCSV' DELIMITER ';' ENCODING 'WIN1252' CSV QUOTE '"';

--______________________________________________________________________________________________
